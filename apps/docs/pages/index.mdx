import { Mermaid } from '../components/Mermaid';

# Stolen Wallet Registry

The Stolen Wallet Registry (SWR) is a cross-chain, on-chain fraud registry. Victims of crypto theft register compromised wallets, flagged transactions, and malicious contracts - creating a shared fraud intelligence layer that exchanges, wallets, and dApps can query.

DAO-approved operators (exchanges, security firms, blockchain investigators) can submit batch fraud data at scale, making the registry an industry-grade data source rather than just a self-reporting tool. See the [Operator Protocol](/operator) for details on how operators participate.

## Three Registries

| Registry        | What gets registered                    | Who can submit          | Security model                                    |
| --------------- | --------------------------------------- | ----------------------- | ------------------------------------------------- |
| **Wallet**      | Compromised wallet addresses            | Individuals + Operators | Two-phase EIP-712 / DAO-approved batch            |
| **Transaction** | Fraudulent transaction hashes (batched) | Individuals + Operators | Two-phase EIP-712 + dataHash / DAO-approved batch |
| **Contract**    | Malicious contract addresses            | Operators only          | DAO-approved batch submission                     |

## Three Registration Methods

| Method         | How it works                                               | Best for                                        |
| -------------- | ---------------------------------------------------------- | ----------------------------------------------- |
| **Standard**   | Sign and pay with the wallet you are registering           | Compromised wallet still has funds              |
| **Self-Relay** | Sign with compromised wallet, pay with a different wallet  | Wallet drained, but you have another with funds |
| **P2P Relay**  | Sign with compromised wallet, a helper pays gas via libp2p | No funds on any wallet, a friend can help       |

## Architecture

<Mermaid chart={`
graph TB
    Users([Users / Operators])

    subgraph Frontend
        WebApp[Web App]
        CLI[Operator CLI]
    end

    subgraph Hub Chain
        Hub[FraudRegistryHub]
        WR[WalletRegistry]
        TR[TransactionRegistry]
        CR[ContractRegistry]
    end

    subgraph Spoke Chains
        Spoke[SpokeRegistry]
        Adapter[Bridge Adapter]
    end

    Inbox[CrossChainInbox]
    Indexer[Ponder Indexer]
    Dashboard[Dashboard + Search]

    Users --> WebApp
    Users --> CLI
    WebApp --> Hub
    WebApp --> Spoke
    CLI --> Hub
    Hub --> WR
    Hub --> TR
    Hub --> CR
    Spoke --> Adapter
    Adapter -->|Cross-Chain Message| Inbox
    Inbox --> Hub
    WR --> Indexer
    TR --> Indexer
    CR --> Indexer
    Indexer --> Dashboard

`} />

## Security Model

Every user submission wallet and transaction registration requires **two separate signatures** with a randomized delay between them. This two-phase EIP-712 flow prevents single-transaction phishing attacks - an attacker cannot trick a victim into registering a legitimate wallet in one step.

Operator submissions bypass the two-phase flow but are protected by a **DAO trust model** - only entities explicitly approved by governance vote (exchanges, security firms, blockchain analytics providers) can submit batch registrations. The DAO approval process is the security control that substitutes for the individual signature requirement.

[Learn more about two-phase registration](/concepts/two-phase-registration)

## Explore the Docs

| Section                                           | What you will find                                        |
| ------------------------------------------------- | --------------------------------------------------------- |
| [Quick Start](/getting-started/quick-start)       | Run the app locally in under 5 minutes                    |
| [Core Concepts](/concepts/two-phase-registration) | Two-phase registration, CAIP identifiers, hub-spoke model |
| [Registries](/registries/wallet)                  | Deep dives into each registry contract                    |
| [Operator Protocol](/operator)                    | Batch submissions, economics, CLI usage                   |
| [P2P Relay](/p2p)                                 | libp2p architecture and protocol details                  |
| [Infrastructure](/infrastructure/fee-manager)     | Fee manager, soulbound tokens, indexer                    |
| [Philosophy](/philosophy/manifesto)               | Manifesto and governance model                            |
